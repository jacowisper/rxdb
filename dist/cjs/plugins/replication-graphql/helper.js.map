{"version":3,"file":"helper.js","names":["_index","require","GRAPHQL_REPLICATION_PLUGIN_IDENTITY_PREFIX","exports","graphQLRequest","fetchRequest","httpUrl","clientState","queryParams","headers","Headers","append","req","Request","ensureNotFalsy","method","body","JSON","stringify","credentials","then","res","json","getDataFromResult","result","userDefinedDataPath","dataPath","Object","keys","data","getProperty"],"sources":["../../../../src/plugins/replication-graphql/helper.ts"],"sourcesContent":["import type { RxGraphQLReplicationClientState, RxGraphQLReplicationQueryBuilderResponseObject } from '../../types/index.d.ts';\r\nimport { ensureNotFalsy, getProperty } from '../../plugins/utils/index.ts';\r\n\r\nexport const GRAPHQL_REPLICATION_PLUGIN_IDENTITY_PREFIX = 'graphql';\r\n\r\nexport interface GraphQLError {\r\n    message: string;\r\n    locations: Array<{\r\n        line: number;\r\n        column: number;\r\n    }>;\r\n    path: string[];\r\n}\r\nexport type GraphQLErrors = Array<GraphQLError>;\r\n\r\n\r\n\r\nexport function graphQLRequest(\r\n    fetchRequest: WindowOrWorkerGlobalScope['fetch'],\r\n    httpUrl: string,\r\n    clientState: RxGraphQLReplicationClientState,\r\n    queryParams: RxGraphQLReplicationQueryBuilderResponseObject\r\n) {\r\n\r\n    const headers = new Headers(clientState.headers || {});\r\n    headers.append('Content-Type', 'application/json');\r\n\r\n    const req = new Request(\r\n        ensureNotFalsy(httpUrl),\r\n        {\r\n            method: 'POST',\r\n            body: JSON.stringify(queryParams),\r\n            headers,\r\n            credentials: clientState.credentials,\r\n        }\r\n    );\r\n    \r\n    return fetchRequest(req)\r\n        .then((res) => res.json())\r\n        .then((body) => {\r\n            return body;\r\n        });\r\n}\r\n\r\nexport function getDataFromResult(\r\n    result: { data: object },\r\n    userDefinedDataPath: string | string[] | undefined\r\n): any {\r\n    const dataPath = userDefinedDataPath || ['data', Object.keys(result.data)[0]];\r\n    const data: any = getProperty(result, dataPath);\r\n    return data;\r\n}"],"mappings":";;;;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEO,IAAMC,0CAA0C,GAAAC,OAAA,CAAAD,0CAAA,GAAG,SAAS;AAc5D,SAASE,cAAcA,CAC1BC,YAAgD,EAChDC,OAAe,EACfC,WAA4C,EAC5CC,WAA2D,EAC7D;EAEE,IAAMC,OAAO,GAAG,IAAIC,OAAO,CAACH,WAAW,CAACE,OAAO,IAAI,CAAC,CAAC,CAAC;EACtDA,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;EAElD,IAAMC,GAAG,GAAG,IAAIC,OAAO,CACnB,IAAAC,qBAAc,EAACR,OAAO,CAAC,EACvB;IACIS,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACV,WAAW,CAAC;IACjCC,OAAO;IACPU,WAAW,EAAEZ,WAAW,CAACY;EAC7B,CACJ,CAAC;EAED,OAAOd,YAAY,CAACO,GAAG,CAAC,CACnBQ,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEJ,IAAI,IAAK;IACZ,OAAOA,IAAI;EACf,CAAC,CAAC;AACV;AAEO,SAASO,iBAAiBA,CAC7BC,MAAwB,EACxBC,mBAAkD,EAC/C;EACH,IAAMC,QAAQ,GAAGD,mBAAmB,IAAI,CAAC,MAAM,EAAEE,MAAM,CAACC,IAAI,CAACJ,MAAM,CAACK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7E,IAAMA,IAAS,GAAG,IAAAC,kBAAW,EAACN,MAAM,EAAEE,QAAQ,CAAC;EAC/C,OAAOG,IAAI;AACf","ignoreList":[]}