{"version":3,"file":"index.js","names":["_rxStorageHelper","require","_utilsRxdbVersion","_rxStorageInstanceFoundationdb","_foundationdbTypes","Object","keys","forEach","key","prototype","hasOwnProperty","call","_exportNames","exports","defineProperty","enumerable","get","_foundationdbHelpers","versionSet","getRxStorageFoundationDB","settings","apiVersion","Error","setAPIVersion","storage","name","rxdbVersion","RXDB_VERSION","createStorageInstance","params","ensureRxStorageInstanceParamsAreCorrect","useSettings","assign","options","batchSize","createFoundationDBStorageInstance"],"sources":["../../../../src/plugins/storage-foundationdb/index.ts"],"sourcesContent":["import { ensureRxStorageInstanceParamsAreCorrect } from '../../rx-storage-helper.ts';\r\nimport type {\r\n    RxStorageInstanceCreationParams\r\n} from '../../types/index.d.ts';\r\nimport { RXDB_VERSION } from '../utils/utils-rxdb-version.ts';\r\nimport type {\r\n    RxStorageFoundationDB,\r\n    RxStorageFoundationDBInstanceCreationOptions,\r\n    RxStorageFoundationDBSettings\r\n} from './foundationdb-types.ts';\r\n\r\nimport {\r\n    createFoundationDBStorageInstance,\r\n    RxStorageInstanceFoundationDB\r\n} from './rx-storage-instance-foundationdb.ts';\r\n\r\n\r\nlet versionSet: undefined | number;\r\n\r\nexport function getRxStorageFoundationDB(\r\n    settings: RxStorageFoundationDBSettings\r\n): RxStorageFoundationDB {\r\n    if (versionSet && versionSet !== settings.apiVersion) {\r\n        throw new Error('foundationdb already initialized with api version ' + versionSet);\r\n    } else if (!versionSet) {\r\n        versionSet = settings.apiVersion;\r\n        const { setAPIVersion } = require('foundationdb');\r\n        setAPIVersion(settings.apiVersion);\r\n    }\r\n\r\n\r\n    const storage: RxStorageFoundationDB = {\r\n        name: 'foundationdb',\r\n        rxdbVersion: RXDB_VERSION,\r\n\r\n        createStorageInstance<RxDocType>(\r\n            params: RxStorageInstanceCreationParams<RxDocType, RxStorageFoundationDBInstanceCreationOptions>\r\n        ): Promise<RxStorageInstanceFoundationDB<RxDocType>> {\r\n            ensureRxStorageInstanceParamsAreCorrect(params);\r\n            const useSettings = Object.assign(\r\n                {},\r\n                settings,\r\n                params.options\r\n            );\r\n            if (!useSettings.batchSize) {\r\n                useSettings.batchSize = 50;\r\n            }\r\n            return createFoundationDBStorageInstance(this, params, useSettings);\r\n        }\r\n    };\r\n\r\n    return storage;\r\n}\r\n\r\n\r\nexport * from './foundationdb-types.ts';\r\nexport * from './foundationdb-helpers.ts';\r\n"],"mappings":";;;;;;;;;AAAA,IAAAA,gBAAA,GAAAC,OAAA;AAIA,IAAAC,iBAAA,GAAAD,OAAA;AAOA,IAAAE,8BAAA,GAAAF,OAAA;AA4CA,IAAAG,kBAAA,GAAAH,OAAA;AAAAI,MAAA,CAAAC,IAAA,CAAAF,kBAAA,EAAAG,OAAA,WAAAC,GAAA;EAAA,IAAAA,GAAA,kBAAAA,GAAA;EAAA,IAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAC,YAAA,EAAAJ,GAAA;EAAA,IAAAA,GAAA,IAAAK,OAAA,IAAAA,OAAA,CAAAL,GAAA,MAAAJ,kBAAA,CAAAI,GAAA;EAAAH,MAAA,CAAAS,cAAA,CAAAD,OAAA,EAAAL,GAAA;IAAAO,UAAA;IAAAC,GAAA,WAAAA,CAAA;MAAA,OAAAZ,kBAAA,CAAAI,GAAA;IAAA;EAAA;AAAA;AACA,IAAAS,oBAAA,GAAAhB,OAAA;AAAAI,MAAA,CAAAC,IAAA,CAAAW,oBAAA,EAAAV,OAAA,WAAAC,GAAA;EAAA,IAAAA,GAAA,kBAAAA,GAAA;EAAA,IAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAC,YAAA,EAAAJ,GAAA;EAAA,IAAAA,GAAA,IAAAK,OAAA,IAAAA,OAAA,CAAAL,GAAA,MAAAS,oBAAA,CAAAT,GAAA;EAAAH,MAAA,CAAAS,cAAA,CAAAD,OAAA,EAAAL,GAAA;IAAAO,UAAA;IAAAC,GAAA,WAAAA,CAAA;MAAA,OAAAC,oBAAA,CAAAT,GAAA;IAAA;EAAA;AAAA;AAvCA,IAAIU,UAA8B;AAE3B,SAASC,wBAAwBA,CACpCC,QAAuC,EAClB;EACrB,IAAIF,UAAU,IAAIA,UAAU,KAAKE,QAAQ,CAACC,UAAU,EAAE;IAClD,MAAM,IAAIC,KAAK,CAAC,oDAAoD,GAAGJ,UAAU,CAAC;EACtF,CAAC,MAAM,IAAI,CAACA,UAAU,EAAE;IACpBA,UAAU,GAAGE,QAAQ,CAACC,UAAU;IAChC,IAAM;MAAEE;IAAc,CAAC,GAAGtB,OAAO,CAAC,cAAc,CAAC;IACjDsB,aAAa,CAACH,QAAQ,CAACC,UAAU,CAAC;EACtC;EAGA,IAAMG,OAA8B,GAAG;IACnCC,IAAI,EAAE,cAAc;IACpBC,WAAW,EAAEC,8BAAY;IAEzBC,qBAAqBA,CACjBC,MAAgG,EAC/C;MACjD,IAAAC,wDAAuC,EAACD,MAAM,CAAC;MAC/C,IAAME,WAAW,GAAG1B,MAAM,CAAC2B,MAAM,CAC7B,CAAC,CAAC,EACFZ,QAAQ,EACRS,MAAM,CAACI,OACX,CAAC;MACD,IAAI,CAACF,WAAW,CAACG,SAAS,EAAE;QACxBH,WAAW,CAACG,SAAS,GAAG,EAAE;MAC9B;MACA,OAAO,IAAAC,gEAAiC,EAAC,IAAI,EAAEN,MAAM,EAAEE,WAAW,CAAC;IACvE;EACJ,CAAC;EAED,OAAOP,OAAO;AAClB","ignoreList":[]}